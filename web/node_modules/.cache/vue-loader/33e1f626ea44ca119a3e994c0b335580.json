{"remainingRequest":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\src\\views\\chat.vue?vue&type=style&index=0&id=1d4b131c&lang=scss&scoped=true&","dependencies":[{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\src\\views\\chat.vue","mtime":1697877337559},{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\postgraduate\\高中数学课程\\高级软工\\wego\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jaGF0LWJveCB7CiAgbWFyZ2luOiAwIGF1dG87CiAgYmFja2dyb3VuZDogI2ZhZmFmYTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgaGVpZ2h0OiAxMDAlOwogIHdpZHRoOiAxMDAlOwogIG1heC13aWR0aDogNzAwcHg7CmhlYWRlciB7CiAgcG9zaXRpb246IGZpeGVkOwogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogM3JlbTsKICBiYWNrZ3JvdW5kOiAjNDA5ZWZmOwogIG1heC13aWR0aDogNzAwcHg7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGNvbG9yOiB3aGl0ZTsKICBmb250LXNpemU6IDFyZW07Cn0KLm1zZy1ib3ggewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDYuNXJlbSk7CiAgd2lkdGg6IDEwMCU7CiAgbWFyZ2luLXRvcDogM3JlbTsKICBvdmVyZmxvdy15OiBzY3JvbGw7Ci5tc2cgewogIHdpZHRoOiA5NSU7CiAgbWluLWhlaWdodDogMi41cmVtOwogIG1hcmdpbjogMXJlbSAwLjVyZW07CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0ICFpbXBvcnRhbnQ7Ci51c2VyLWhlYWQgewogIG1pbi13aWR0aDogMi41cmVtOwogIHdpZHRoOiAyMCU7CiAgd2lkdGg6IDIuNXJlbTsKICBoZWlnaHQ6IDIuNXJlbTsKICBib3JkZXItcmFkaXVzOiA1MCU7CiAgYmFja2dyb3VuZDogI2YxZjFmMTsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7Ci5oZWFkIHsKICB3aWR0aDogMS4ycmVtOwogIGhlaWdodDogMS4ycmVtOwp9Ci8vIHBvc2l0aW9uOiBhYnNvbHV0ZTsKfQoudXNlci1tc2cgewogIHdpZHRoOiA4MCU7Ci8vIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB3b3JkLWJyZWFrOiBicmVhay1hbGw7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIHotaW5kZXg6IDU7CnNwYW4gewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBwYWRkaW5nOiAwLjVyZW0gMC43cmVtOwogIGJvcmRlci1yYWRpdXM6IDAuNXJlbTsKICBtYXJnaW4tdG9wOiAwLjJyZW07CiAgZm9udC1zaXplOiAwLjg4cmVtOwp9Ci5sZWZ0IHsKICBiYWNrZ3JvdW5kOiB3aGl0ZTsKICBhbmltYXRpb246IHRvTGVmdCAwLjVzIGVhc2UgYm90aCAxOwp9Ci5yaWdodCB7CiAgYmFja2dyb3VuZDogIzUzYThmZjsKICBjb2xvcjogd2hpdGU7CiAgYW5pbWF0aW9uOiB0b3JpZ2h0IDAuNXMgZWFzZSBib3RoIDE7Cn0KQGtleWZyYW1lcyB0b0xlZnQgewogIDAlIHsKICAgIG9wYWNpdHk6IDA7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTEwcHgpOwogIH0KICAxMDAlIHsKICAgIG9wYWNpdHk6IDE7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMHB4KTsKICB9Cn0KQGtleWZyYW1lcyB0b3JpZ2h0IHsKICAwJSB7CiAgICBvcGFjaXR5OiAwOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDEwcHgpOwogIH0KICAxMDAlIHsKICAgIG9wYWNpdHk6IDE7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMHB4KTsKICB9Cn0KfQp9Cn0KLmlucHV0LWJveCB7CiAgcGFkZGluZzogMCAwLjVyZW07CiAgcG9zaXRpb246IGFic29sdXRlOwogIGJvdHRvbTogMDsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDMuNXJlbTsKICBiYWNrZ3JvdW5kOiAjZmFmYWZhOwogIGJveC1zaGFkb3c6IDAgMCA1cHggI2NjYzsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICBhbGlnbi1pdGVtczogY2VudGVyOwppbnB1dCB7CiAgaGVpZ2h0OiAyLjNyZW07CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAxMDAlOwogIHBhZGRpbmc6IDAuNXJlbTsKICBib3JkZXI6IG5vbmU7CiAgYm9yZGVyLXJhZGl1czogMC4ycmVtOwogIGZvbnQtc2l6ZTogMC44OHJlbTsKfQouYnRuIHsKICBoZWlnaHQ6IDIuM3JlbTsKICBtaW4td2lkdGg6IDRyZW07CiAgYmFja2dyb3VuZDogI2UwZTBlMDsKICBwYWRkaW5nOiAwLjVyZW07CiAgZm9udC1zaXplOiAwLjg4cmVtOwogIGNvbG9yOiB3aGl0ZTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgYm9yZGVyLXJhZGl1czogMC4ycmVtOwogIG1hcmdpbi1sZWZ0OiAwLjVyZW07CiAgdHJhbnNpdGlvbjogMC41czsKfQouYnRuLWFjdGl2ZSB7CiAgYmFja2dyb3VuZDogIzQwOWVmZjsKfQp9Cn0K"},{"version":3,"sources":["chat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"chat.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"chat-box\">\r\n    <header>与{{userId}}聊天</header>\r\n    <div class=\"msg-box\" ref=\"msg-box\">\r\n      <div\r\n        v-for=\"(i,index) in list\"\r\n        :key=\"index\"\r\n        class=\"msg\"\r\n        \r\n      >\r\n        <!-- <div class=\"user-head\">\r\n          <img :src=\"i.avatar\" height=\"30\" width=\"30\" :title=\"i.username\">\r\n        </div> -->\r\n        <div class=\"user-msg\">\r\n          <span :style=\"i.toId == userId?' float: right;':''\" :class=\"i.toId == userId?'right':'left'\">{{i.messageContent}}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"input-box\">\r\n      <input type=\"text\" ref=\"sendMsg\" v-model=\"contentText\" @keyup.enter=\"sendText()\" />\r\n      <div class=\"btn\" :class=\"{['btn-active']:contentText}\" @click=\"sendText()\">发送</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        ws: null,\r\n        count: 0,\r\n        // userId: this.$store.getters.id, // 当前用户ID\r\n        // username: this.$store.getters.name, // 当前用户昵称\r\n        // avatar: this.$store.getters.avatar, // 当前用户头像\r\n        list: [], // 聊天记录的数组\r\n        contentText: \"\", // input输入的值\r\n        userId: 0,\r\n        myUserId: 0\r\n      };\r\n    },\r\n    mounted() {\r\n        console.log(this.$route.params)\r\n        this.userId = this.$route.params.userId,\r\n        this.initWebSocket();\r\n        this.myUserId = localStorage.getItem('user')\r\n        console.log(123,this.myUserId)\r\n    },\r\n\r\n    destroyed() {\r\n      // 离开页面时关闭websocket连接\r\n      this.ws.onclose(undefined);\r\n    },\r\n    methods: {\r\n      // 发送聊天信息\r\n      sendText() {\r\n        let _this = this;\r\n        _this.$refs[\"sendMsg\"].focus();\r\n        if (!_this.contentText) {\r\n          return;\r\n        }\r\n        let params = {\r\n          toId: _this.userId,\r\n          messageContent: _this.contentText,\r\n          fromId: _this.myUserId,\r\n        };\r\n        _this.ws.send(JSON.stringify(params)); //调用WebSocket send()发送信息的方法\r\n        _this.list.push(params)\r\n        _this.contentText = \"\";\r\n        setTimeout(() => {\r\n          _this.scrollBottm();\r\n        }, 500);\r\n      },\r\n      // 进入页面创建websocket连接\r\n      initWebSocket() {\r\n        let _this = this;\r\n        // 判断页面有没有存在websocket连接\r\n        if (window.WebSocket) {\r\n          //var serverHot =  window.location.hostname;\r\n          //let sip = '房间号'\r\n          // 填写本地IP地址 此处的 :9101端口号 要与后端配置的一致！\r\n          //var url = 'ws://' + serverHot + ':9101' + '/groupChat/' + sip + '/' + this.userId; // `ws://127.0.0.1/9101/groupChat/10086/聊天室`\r\n          //this.websocket = new WebSocket(`ws://localhost:8081/${id}`);\r\n          let url = `ws://localhost:8081/chat/${_this.userId}`;\r\n          let ws = new WebSocket(url);\r\n          _this.ws = ws;\r\n          ws.onopen = function(e) {\r\n            console.log(\"服务器连接成功: \" + url,e);\r\n            //ws.send(_this.userId)\r\n          };\r\n          ws.onclose = function(e) {\r\n            console.log(\"服务器连接关闭: \" + url,e);\r\n          };\r\n          ws.onerror = function() {\r\n            console.log(\"服务器连接出错: \" + url);\r\n          };\r\n          ws.onmessage = function(e) {\r\n            //接收服务器返回的数据\r\n            let resData = JSON.parse(e.data)\r\n            console.log('接收数据',resData)\r\n            // _this.list = [\r\n            //   ..._this.list,\r\n            //   { userId: resData.userId, username: resData.username, avatar: resData.avatar, content: resData.msg }\r\n            // ];\r\n            _this.list.push(resData)\r\n            console.log('消息列表',_this.list)\r\n          };\r\n        }\r\n      },\r\n      // 滚动条到底部\r\n      scrollBottm() {\r\n          let el = this.$refs[\"msg-box\"];\r\n          el.scrollTop = el.scrollHeight;\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .chat-box {\r\n    margin: 0 auto;\r\n    background: #fafafa;\r\n    position: absolute;\r\n    height: 100%;\r\n    width: 100%;\r\n    max-width: 700px;\r\n  header {\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 3rem;\r\n    background: #409eff;\r\n    max-width: 700px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-weight: bold;\r\n    color: white;\r\n    font-size: 1rem;\r\n  }\r\n  .msg-box {\r\n    position: absolute;\r\n    height: calc(100% - 6.5rem);\r\n    width: 100%;\r\n    margin-top: 3rem;\r\n    overflow-y: scroll;\r\n  .msg {\r\n    width: 95%;\r\n    min-height: 2.5rem;\r\n    margin: 1rem 0.5rem;\r\n    position: relative;\r\n    display: flex;\r\n    justify-content: flex-start !important;\r\n  .user-head {\r\n    min-width: 2.5rem;\r\n    width: 20%;\r\n    width: 2.5rem;\r\n    height: 2.5rem;\r\n    border-radius: 50%;\r\n    background: #f1f1f1;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  .head {\r\n    width: 1.2rem;\r\n    height: 1.2rem;\r\n  }\r\n  // position: absolute;\r\n  }\r\n  .user-msg {\r\n    width: 80%;\r\n  // position: absolute;\r\n    word-break: break-all;\r\n    position: relative;\r\n    z-index: 5;\r\n  span {\r\n    display: inline-block;\r\n    padding: 0.5rem 0.7rem;\r\n    border-radius: 0.5rem;\r\n    margin-top: 0.2rem;\r\n    font-size: 0.88rem;\r\n  }\r\n  .left {\r\n    background: white;\r\n    animation: toLeft 0.5s ease both 1;\r\n  }\r\n  .right {\r\n    background: #53a8ff;\r\n    color: white;\r\n    animation: toright 0.5s ease both 1;\r\n  }\r\n  @keyframes toLeft {\r\n    0% {\r\n      opacity: 0;\r\n      transform: translateX(-10px);\r\n    }\r\n    100% {\r\n      opacity: 1;\r\n      transform: translateX(0px);\r\n    }\r\n  }\r\n  @keyframes toright {\r\n    0% {\r\n      opacity: 0;\r\n      transform: translateX(10px);\r\n    }\r\n    100% {\r\n      opacity: 1;\r\n      transform: translateX(0px);\r\n    }\r\n  }\r\n  }\r\n  }\r\n  }\r\n  .input-box {\r\n    padding: 0 0.5rem;\r\n    position: absolute;\r\n    bottom: 0;\r\n    width: 100%;\r\n    height: 3.5rem;\r\n    background: #fafafa;\r\n    box-shadow: 0 0 5px #ccc;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  input {\r\n    height: 2.3rem;\r\n    display: inline-block;\r\n    width: 100%;\r\n    padding: 0.5rem;\r\n    border: none;\r\n    border-radius: 0.2rem;\r\n    font-size: 0.88rem;\r\n  }\r\n  .btn {\r\n    height: 2.3rem;\r\n    min-width: 4rem;\r\n    background: #e0e0e0;\r\n    padding: 0.5rem;\r\n    font-size: 0.88rem;\r\n    color: white;\r\n    text-align: center;\r\n    border-radius: 0.2rem;\r\n    margin-left: 0.5rem;\r\n    transition: 0.5s;\r\n  }\r\n  .btn-active {\r\n    background: #409eff;\r\n  }\r\n  }\r\n  }\r\n</style>\r\n"]}]}